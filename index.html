<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>5-Day Hybrid Gym Plan — Pocket Coach</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<style>
  :root{
    --bg:#fbfcfe;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#1167b1;
    --accent-2:#0ea5a0;
    --accent-3:#f59e0b;
    --success:#059669;
    --danger:#ef4444;
    --glass: rgba(255,255,255,0.7);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    --radius:12px;
    --pad:14px;
  }
  html,body{height:100%;background:linear-gradient(180deg,#f6fbff,#fbfcfe);margin:0;color:#0f172a;}
  .app{max-width:980px;margin:12px auto;padding:12px;}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:14px}
  h1{font-size:20px;margin:0;color:var(--accent)}
  p.lead{margin:4px 0 0;color:var(--muted);font-size:13px}
  .goals{
    background:var(--card);border-radius:var(--radius);padding:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06);
    display:flex;flex-wrap:wrap;gap:8px;align-items:center;
  }
  .goal-btn{
    padding:8px 10px;border-radius:10px;border:1px solid #e6eef9;background:transparent;color:var(--muted);
    font-size:13px;display:inline-flex;gap:8px;align-items:center;cursor:pointer;transition:all .15s;
  }
  .goal-btn.active{background:linear-gradient(90deg,var(--accent)10%,#2b8bdc);color:white;border-color:transparent;box-shadow:0 6px 18px rgba(17,103,177,0.12)}
  .controls{display:flex;gap:8px;align-items:center}
  button.icon{border:0;background:var(--card);padding:8px;border-radius:10px;box-shadow:0 6px 18px rgba(15,23,42,0.04);cursor:pointer}

  main{margin-top:12px;display:grid;grid-template-columns:1fr;gap:12px}
  .day{
    background:var(--card);border-radius:14px;padding:12px;box-shadow:0 10px 30px rgba(10,20,40,0.04);overflow:hidden;
  }
  .day-header{display:flex;align-items:center;justify-content:space-between;gap:10px;cursor:pointer}
  .day-title{display:flex;gap:12px;align-items:center}
  .day-title h2{margin:0;font-size:16px}
  .badges{display:flex;gap:8px;align-items:center}
  .badge{font-size:12px;padding:6px 8px;border-radius:999px;background:#eef6ff;color:var(--accent);border:1px solid rgba(17,103,177,0.07)}
  .badge.push{background:#fff7ed;color:var(--accent-3);border-color:rgba(245,158,11,0.06)}
  .badge.pull{background:#f0fdf4;color:var(--success);color:#115e44;border-color:rgba(5,150,105,0.06)}
  .badge.core{background:#f0f9ff;color:var(--accent-2);border-color:rgba(14,165,160,0.06)}

  .exercise-list{margin-top:10px;display:grid;gap:8px}
  .ex{
    display:flex;gap:10px;padding:10px;border-radius:12px;align-items:flex-start;background:linear-gradient(180deg,rgba(250,252,255,1),var(--glass));
    border:1px solid rgba(10,20,40,0.03)
  }
  .ex .left{
    width:34px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;gap:6px
  }
  .ex .mid{display:flex;align-items:center;gap:8px;margin-top:2px;}
  .ex .content{flex:1}

  .ex strong{display:inline;font-size:14px}
  .ex a.ex-link{font-size:14px;text-decoration:none;color:inherit;border-bottom:1px dashed rgba(15,23,42,0.2)}
  .ex a.ex-link:active{opacity:.7}
  .ex small{color:var(--muted);display:block;margin-top:4px;font-size:12px}
  .ex .meta{margin-left:auto;text-align:right;font-size:13px;color:var(--muted)}
  .tag{display:inline-block;padding:4px 8px;border-radius:8px;font-size:11px;margin-left:6px;background:rgba(15,23,42,0.04)}
  .notes{margin-top:6px;color:var(--muted);font-size:12px}
  .finisher{margin-top:8px;padding:10px;border-radius:10px;background:linear-gradient(90deg,#fff,#fbfbff);border:1px dashed rgba(15,23,42,0.04)}
  input[type="checkbox"]{width:20px;height:20px}
  .small{font-size:12px;color:var(--muted)}
  footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
  .controls .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:white;font-size:14px;cursor:pointer}
  .muted{color:var(--muted)}
  button,.goal-btn{touch-action:manipulation}
  .day-panel{max-height:0;overflow:hidden;transition:max-height .28s ease}
  .day-panel.open{max-height:1000px;padding-top:12px}
  @media (min-width:720px){main{grid-template-columns:1fr}}
  @media print{body{background:white}.controls,header,footer{display:none}.day{page-break-inside:avoid;box-shadow:none;border:1px solid #ddd}}

  /* Variant (alternatives) UI */
  .variant-btn{
    display:inline-flex;align-items:center;justify-content:center;
    border:1px solid #e6eef9;background:#fff;border-radius:6px;padding:0 6px;height:20px;cursor:pointer;
    font-size:12px;line-height:1;vertical-align:middle;box-shadow:0 3px 10px rgba(15,23,42,0.04)
  }
  .variant-menu{
    position:absolute;z-index:60;background:var(--card);border:1px solid rgba(15,23,42,0.08);border-radius:10px;padding:8px;
    box-shadow:0 20px 40px rgba(15,23,42,0.15);display:none;min-width:220px;max-width:280px
  }
  .variant-menu.open{display:block}
  .variant-menu h4{margin:4px 6px 8px;font-size:12px;color:var(--muted)}
  .variant-opt{
    display:flex;align-items:flex-start;gap:8px;width:100%;border:0;background:transparent;padding:8px;border-radius:8px;cursor:pointer;text-align:left
  }
  .variant-opt:hover{background:rgba(15,23,42,0.04)}
  .variant-opt .title{font-size:13px}
  .variant-opt .sets{font-size:11px;padding:2px 6px;border-radius:999px;background:rgba(15,23,42,0.06)}
  .variant-opt small{color:var(--muted);display:block;margin-top:2px}
  .variant-opt .cat{margin-left:auto;font-size:11px;color:var(--muted)}

  /* Rest Timer UI */
  .timer-btn,.preset-btn{border:1px solid #e6eef9;background:#fff;border-radius:8px;padding:4px 6px;font-size:11px;cursor:pointer;box-shadow:0 3px 10px rgba(15,23,42,0.04)}
  .timer-btn{display:inline-flex;align-items:center;gap:4px}
  .timer-btn:active{transform:scale(.98)}
  .preset-btn{font-size:10px;opacity:.8}
  .rt-menu{position:absolute;z-index:55;background:var(--card);border:1px solid rgba(15,23,42,0.08);border-radius:10px;padding:6px;box-shadow:0 20px 40px rgba(15,23,42,0.15);display:none;min-width:160px}
  .rt-menu.open{display:block}
  .rt-menu h4{margin:4px 6px 6px;font-size:12px;color:var(--muted)}
  .rt-row{display:flex;flex-wrap:wrap;gap:6px}
  .rt-chip{border:1px solid #e6eef9;background:#fff;border-radius:999px;padding:6px 10px;font-size:12px;cursor:pointer}
  .rt-chip.active{background:#eef6ff;color:var(--accent);border-color:rgba(17,103,177,0.18)}
  .running-timers{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;display:flex;flex-direction:column;gap:8px;z-index:9999}
  .timer-pill{display:flex;align-items:center;gap:8px;background:var(--card);border:1px solid rgba(15,23,42,0.08);border-radius:999px;padding:8px 12px;box-shadow:0 10px 30px rgba(0,0,0,.15);font-size:13px}
  .timer-pill .name{max-width:44vw;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .timer-pill .time{font-variant-numeric:tabular-nums;color:var(--muted)}
  .timer-pill button{border:0;background:transparent;color:var(--danger);font-size:16px;line-height:1;cursor:pointer}
</style>
</head>
<body>
<div class="app" role="application" aria-label="Gym pocket coach">
  <header>
    <div>
      <h1>5-Day Hybrid Plan • Pocket Coach</h1>
      <p class="lead">Balanced strength, shaping, core & conditioning.</p>
    </div>
    <div class="controls">
      <button class="icon" id="expandAll" title="Expand all" aria-label="Expand all">▸▸</button>
      <button class="icon" id="collapseAll" title="Collapse all" aria-label="Collapse all">▾▾</button>
      <button class="icon" id="clearChecks" title="Clear today's checks" aria-label="Clear checks">⟳</button>
    </div>
  </header>

  <section class="goals" aria-label="Resources">
    <div style="min-width:72px"><strong class="small">Resources</strong></div>
    <a class="goal-btn" href="https://musclewiki.com/" target="_blank" rel="noopener">Wiki Exercises</a>
    <a class="goal-btn" href="https://exrx.net/Lists/Directory" target="_blank" rel="noopener">ExRx Exercises</a>
    <a class="goal-btn" href="https://exrx.net/Lists/CardioExercises" target="_blank" rel="noopener">ExRx Cardio</a>
  </section>

  <main>
    <!-- Day 1 -->
    <article class="day" id="day-1">
      <div class="day-header" data-day="1" tabindex="0">
        <div class="day-title">
          <div>
            <h2>Day 1 — Upper (Strength + Size)</h2>
            <div class="small muted">Push & Pull balanced • emphasis on chest, back, shoulders</div>
          </div>
        </div>
        <div class="badges">
          <span class="badge push">Push</span>
          <span class="badge pull">Pull</span>
          <span class="badge core">Core</span>
        </div>
      </div>
      <section class="day-panel" aria-hidden="true">
        <div class="exercise-list">
          <div class="ex" data-ex="Barbell Bench Press">
            <div class="left">
              <input type="checkbox" data-key="d1-bench">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Barbell Bench Press <span class="tag">4×6</span></strong></a>
              <small>Targets: Mid chest (pectoralis major), front delts, triceps • Push compound for pressing strength & size.</small>
              <div class="notes small">Tip: tuck elbows ~45°, drive feet, press in an arc. Controlled descent, explosive up.</div>
            </div>
            <div class="meta">Push</div>
          </div>

          <div class="ex" data-ex="Pull-Ups">
            <div class="left">
              <input type="checkbox" data-key="d1-pullups">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Pull-Ups / Lat Pulldown <span class="tag">4×6–8</span></strong></a>
              <small>Targets: Lats (width), biceps, rear delts • Vertical pulling motion for back width.</small>
              <div class="notes small">Tip: full range of motion, chest to bar. Use assistance if needed; add weight when strong.</div>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex" data-ex="Overhead Press">
            <div class="left">
              <input type="checkbox" data-key="d1-ohp">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Overhead Press (Barbell/Dumbbell) <span class="tag">3×8</span></strong></a>
              <small>Targets: Shoulders (front + side delts), triceps • Standing press builds upper-body pressing power and core stability.</small>
              <div class="notes small">Tip: braced core, slightly overhead bar path, avoid excessive lumbar arch.</div>
            </div>
            <div class="meta">Push</div>
          </div>

          <div class="ex" data-ex="Barbell Row">
            <div class="left">
              <input type="checkbox" data-key="d1-row">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Barbell Row <span class="tag">3×8–10</span></strong></a>
              <small>Targets: Back thickness (lats, rhomboids, traps), rear delts, biceps • Horizontal pull to balance pressing.</small>
              <div class="notes small">Tip: chest up, hips back; pull bar to low chest. Use strict form to protect lower back.</div>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex" data-ex="Lateral Raises">
            <div class="left">
              <input type="checkbox" data-key="d1-latraise">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Dumbbell Lateral Raises <span class="tag">2×12–15</span></strong></a>
              <small>Targets: Side delts • Isolation for shoulder cap and width.</small>
              <div class="notes small">Tip: light weight, lead with elbow, small range for side delt focus.</div>
            </div>
            <div class="meta">Accessory</div>
          </div>
        </div>

        <div class="finisher small">
          Optional Finisher • 10 min: Bike or Rower intervals (30s hard / 60s easy) — cardio + metabolic conditioning.
        </div>
      </section>
    </article>

    <!-- Day 2 -->
    <article class="day" id="day-2">
      <div class="day-header" data-day="2" tabindex="0">
        <div class="day-title">
          <div>
            <h2>Day 2 — Lower (Strength + Core)</h2>
            <div class="small muted">Quads, glutes, hamstrings • posture and core emphasis</div>
          </div>
        </div>
        <div class="badges">
          <span class="badge push">Legs</span>
          <span class="badge core">Core</span>
        </div>
      </div>

      <section class="day-panel" aria-hidden="true">
        <div class="exercise-list">
          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d2-squat">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Back Squat <span class="tag">4×6</span></strong></a>
              <small>Targets: Quads, glutes, core • Foundation for lower-body strength.</small>
              <div class="notes small">Tip: neutral spine, knees tracking toes. Depth as mobility allows. Drive through heels.</div>
            </div>
            <div class="meta">Legs</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d2-rdl">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Romanian Deadlift <span class="tag">3×8</span></strong></a>
              <small>Targets: Hamstrings, glutes, lower back (erector spinae) • Posterior chain strength.</small>
              <div class="notes small">Tip: hinge at hips, slight knee bend, keep bar close to legs.</div>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d2-lunge">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Walking Lunges <span class="tag">2×12/leg</span></strong></a>
              <small>Targets: Quads, glutes, single-leg stability.</small>
              <div class="notes small">Tip: long stride for glute focus; short stride for quad focus.</div>
            </div>
            <div class="meta">Legs</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d2-hangleg">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Hanging Leg Raises <span class="tag">3×12–15</span></strong></a>
              <small>Targets: Lower abs, hip flexors • Great for core and midsection definition.</small>
            </div>
            <div class="meta">Core</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d2-sideplank">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Side Plank <span class="tag">3×30–45s/side</span></strong></a>
              <small>Targets: Obliques, transverse abdominis • Anti-rotation & posture support.</small>
            </div>
            <div class="meta">Core</div>
          </div>
        </div>
      </section>
    </article>

    <!-- Day 3 -->
    <article class="day" id="day-3">
      <div class="day-header" data-day="3" tabindex="0">
        <div class="day-title">
          <div>
            <h2>Day 3 — Hybrid Conditioning (Push + Pull + Cardio)</h2>
            <div class="small muted">Mix of strength & cardio • whole-body conditioning</div>
          </div>
        </div>
        <div class="badges">
          <span class="badge push">Hybrid</span>
          <span class="badge core">Conditioning</span>
        </div>
      </div>

      <section class="day-panel" aria-hidden="true">
        <div class="exercise-list">
          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d3-incline">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Incline Dumbbell Press <span class="tag">3×8–10</span></strong></a>
              <small>Targets: Upper chest, front delts • Great for chest shaping and upper pec development.</small>
            </div>
            <div class="meta">Push</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d3-row">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Seated Cable Row <span class="tag">3×10</span></strong></a>
              <small>Targets: Mid back, rear delts, biceps • Controlled horizontal pulling.</small>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d3-swing">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Kettlebell Swings <span class="tag">3×15</span></strong></a>
              <small>Targets: Glutes, hamstrings, lower back • Explosive hip hinge for power + conditioning.</small>
            </div>
            <div class="meta">Power</div>
          </div>
        </div>

        <div class="finisher">
          <strong class="small">Circuit Finisher • 3–4 rounds</strong>
          <div class="small muted">250m Row → 15 Push-ups → 15 Goblet Squats → 60s rest</div>
        </div>
      </section>
    </article>

    <!-- Day 4 -->
    <article class="day" id="day-4">
      <div class="day-header" data-day="4" tabindex="0">
        <div class="day-title">
          <div>
            <h2>Day 4 — Upper (Definition & Accessories)</h2>
            <div class="small muted">Accessory emphasis: shape, rear delts, traps, arms</div>
          </div>
        </div>
        <div class="badges">
          <span class="badge push">Push</span>
          <span class="badge pull">Pull</span>
        </div>
      </div>

      <section class="day-panel" aria-hidden="true">
        <div class="exercise-list">
          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-incline">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Incline Bench Press <span class="tag">3×8</span></strong></a>
              <small>Targets: Upper chest • Focused shaping.</small>
            </div>
            <div class="meta">Push</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-pull">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Pull-ups / Lat Pulldown <span class="tag">3×8–10</span></strong></a>
              <small>Targets: Width & lats, great for balanced back development.</small>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-ohplight">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Overhead Press (lighter) <span class="tag">3×10</span></strong></a>
              <small>Targets: Shoulders & triceps • Higher rep variation to add shape.</small>
            </div>
            <div class="meta">Push</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-facepull">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Face Pulls <span class="tag">3×12–15</span></strong></a>
              <small>Targets: Rear delts, rotator cuff, traps • Key for posture and rounded shoulder look.</small>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-biceps">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Biceps Curls <span class="tag">2×12</span></strong></a>
              <small>Targets: Biceps • Definition and arm shaping.</small>
            </div>
            <div class="meta">Accessory</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d4-triceps">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Triceps Rope Pushdowns <span class="tag">2×12</span></strong></a>
              <small>Targets: Triceps • Helps pressing performance and arm definition.</small>
            </div>
            <div class="meta">Accessory</div>
          </div>
        </div>
      </section>
    </article>

    <!-- Day 5 -->
    <article class="day" id="day-5">
      <div class="day-header" data-day="5" tabindex="0">
        <div class="day-title">
          <div>
            <h2>Day 5 — Lower + Core (Glutes, Hams, Stability)</h2>
            <div class="small muted">Lower-body shaping + core finisher</div>
          </div>
        </div>
        <div class="badges">
          <span class="badge push">Legs</span>
          <span class="badge core">Core</span>
        </div>
      </div>

      <section class="day-panel" aria-hidden="true">
        <div class="exercise-list">
          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d5-front">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Front Squat / Goblet Squat <span class="tag">3×8–10</span></strong></a>
              <small>Targets: Quads, core • Front-loading increases core demand & leg shape.</small>
            </div>
            <div class="meta">Legs</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d5-hip">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Barbell Hip Thrust <span class="tag">3×8–10</span></strong></a>
              <small>Targets: Glutes • Primary shaping movement for posterior chain.</small>
            </div>
            <div class="meta">Legs</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d5-legcurl">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Leg Curl <span class="tag">3×10–12</span></strong></a>
              <small>Targets: Hamstrings • Isolation to balance quad work.</small>
            </div>
            <div class="meta">Pull</div>
          </div>

          <div class="ex">
            <div class="left">
              <input type="checkbox" data-key="d5-bulg">
              <button class="timer-btn" data-timer aria-label="Start rest timer">⏱</button>
              <button class="preset-btn" data-preset aria-label="Timer preset">⋯</button>
            </div>
            <div class="mid"><button class="variant-btn" aria-label="Choose alternative">▼</button></div>
            <div class="content">
              <a href="#" class="ex-link"><strong>Bulgarian Split Squat <span class="tag">2×12/leg</span></strong></a>
              <small>Targets: Quads, glutes, single-leg stability.</small>
            </div>
            <div class="meta">Legs</div>
          </div>
        </div>

        <div class="finisher">
          <strong class="small">Core Finisher (2–3 rounds)</strong>
          <div class="small muted">Plank 45s → Russian Twists 20 (weighted) → Back Extensions 12</div>
        </div>
      </section>
    </article>
  </main>

  <footer>
    Tip: Add to Home Screen (Safari) for a quick gym app. Your progress & goals are stored locally on this device.
  </footer>
</div>

<!-- Running timers -->
<div class="running-timers" aria-live="polite" aria-atomic="true"></div>

<script>
(function(){
  const ls = window.localStorage || {};
  const getLS = (k, def) => { try { const v = ls.getItem(k); return v ? JSON.parse(v) : def; } catch(e){return def;} };
  const setLS = (k,v) => { try { ls.setItem(k, JSON.stringify(v)); } catch(e){} };

  // Collapsibles
  const savedExpanded = getLS('pocket:expanded', {});
  document.querySelectorAll('.day').forEach(day=>{
    const header = day.querySelector('.day-header');
    const content = day.querySelector('.day-panel');
    const id = day.id;
    if(savedExpanded[id]) content.classList.add('open'), content.setAttribute('aria-hidden','false');
    header.addEventListener('click', ()=>toggle(id,content));
    header.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){e.preventDefault();toggle(id,content);} });
  });
  function toggle(id,content){ const open=content.classList.toggle('open'); content.setAttribute('aria-hidden', String(!open)); savedExpanded[id]=open; setLS('pocket:expanded', savedExpanded); }
  document.getElementById('expandAll').addEventListener('click', ()=>{ document.querySelectorAll('.day-panel').forEach(c=>{c.classList.add('open'); c.setAttribute('aria-hidden','false');}); setLS('pocket:expanded', Object.fromEntries(Array.from(document.querySelectorAll('.day')).map(d=>[d.id,true])));});
  document.getElementById('collapseAll').addEventListener('click', ()=>{ document.querySelectorAll('.day-panel').forEach(c=>{c.classList.remove('open'); c.setAttribute('aria-hidden','true');}); setLS('pocket:expanded', {});});
  document.getElementById('clearChecks').addEventListener('click', ()=>{ if(!confirm('Clear all saved checks for this device?')) return; document.querySelectorAll('input[type="checkbox"][data-key]').forEach(cb=>cb.checked=false); setLS('pocket:checks', {}); });
  const savedChecks = getLS('pocket:checks', {});
  document.querySelectorAll('input[type="checkbox"][data-key]').forEach(cb=>{ const k=cb.dataset.key; cb.checked=!!savedChecks[k]; cb.addEventListener('change', ()=>{ savedChecks[k]=cb.checked; setLS('pocket:checks', savedChecks); });});
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ document.querySelectorAll('.content.open').forEach(c=>{c.classList.remove('open'); c.setAttribute('aria-hidden','true');}); setLS('pocket:expanded', {});} });
  function flashToast(msg='Saved'){ const t=document.createElement('div'); t.textContent=msg; Object.assign(t.style,{position:'fixed',left:'50%',transform:'translateX(-50%)',bottom:'28px',padding:'10px 14px',background:'rgba(15,23,42,0.9)',color:'#fff',borderRadius:'10px',zIndex:9999,fontSize:'13px',transition:'opacity .25s'}); document.body.appendChild(t); setTimeout(()=>t.style.opacity='0',1200); setTimeout(()=>t.remove(),1700); }

  // ===== Variants (alternatives) =====
  const variantKey = 'pocket:variant';
  const savedVariant = getLS(variantKey, {});
  const VARIANTS = {
    'd1-bench': [
      {id:'barbell-bench', title:'Barbell Bench Press', sets:'4×6', category:'Push', blurb:'Mid chest, front delts, triceps • Pressing strength & size.'},
      {id:'db-bench', title:'Dumbbell Bench Press', sets:'4×8', category:'Push', blurb:'Greater ROM & shoulder freedom; balanced strength.'},
      {id:'machine-chest-press', title:'Machine Chest Press', sets:'4×8', category:'Push', blurb:'Stable path for safe effort; easy drop sets.'},
      {id:'push-ups', title:'Push-Ups (Weighted/Assisted)', sets:'4×AMRAP', category:'Push', blurb:'Bodyweight push; scalable with plates/bands.'}
    ],
    'd1-pullups': [
      {id:'pull-ups', title:'Pull-Ups', sets:'4×6–8', category:'Pull', blurb:'Lats/biceps; full ROM, chest to bar.'},
      {id:'lat-pulldown', title:'Lat Pulldown', sets:'4×8–10', category:'Pull', blurb:'Controlled vertical pull; adjustable load.'},
      {id:'assisted-pullup', title:'Assisted Pull-Up Machine', sets:'4×8–10', category:'Pull', blurb:'Same pattern with consistent support.'},
      {id:'inverted-row', title:'Inverted Row (Smith/TRX)', sets:'4×8–12', category:'Pull', blurb:'Bodyweight horizontal pull; torso rigid.'}
    ],
    'd1-ohp': [
      {id:'barbell-ohp', title:'Barbell Overhead Press', sets:'3×8', category:'Push', blurb:'Shoulders/triceps; standing bracing.'},
      {id:'db-shoulder-press', title:'Dumbbell Shoulder Press (Seated)', sets:'3×8–10', category:'Push', blurb:'Shoulder-friendly path; reduce low-back load.'},
      {id:'machine-shoulder-press', title:'Machine Shoulder Press', sets:'3×10', category:'Push', blurb:'Stable & higher reps for shape.'}
    ],
    'd1-row': [
      {id:'barbell-row', title:'Barbell Row', sets:'3×8–10', category:'Pull', blurb:'Back thickness; strict torso angle.'},
      {id:'seated-cable-row', title:'Seated Cable Row', sets:'3×10', category:'Pull', blurb:'Controlled horizontal pull.'},
      {id:'cs-machine-row', title:'Chest-Supported Row (Machine)', sets:'3×10', category:'Pull', blurb:'Takes low-back out; focus on squeeze.'},
      {id:'db-row', title:'1-Arm Dumbbell Row (Bench)', sets:'3×10/side', category:'Pull', blurb:'Unilateral; lat focus, core anti-rotation.'}
    ],
    'd1-latraise': [
      {id:'db-lateral-raise', title:'Dumbbell Lateral Raises', sets:'2×12–15', category:'Accessory', blurb:'Side delts; light & strict range.'},
      {id:'cable-lateral-raise', title:'Cable Lateral Raise', sets:'2×12–15', category:'Accessory', blurb:'Constant tension; single-arm or dual.'},
      {id:'machine-lateral-raise', title:'Machine Lateral Raise', sets:'2×12–15', category:'Accessory', blurb:'Guided path; easy to control tempo.'}
    ],
    'd2-squat': [
      {id:'back-squat', title:'Back Squat', sets:'4×6', category:'Legs', blurb:'Quads/glutes/core • foundation lift.'},
      {id:'hack-squat', title:'Hack Squat (Machine)', sets:'4×8', category:'Legs', blurb:'Quad focus; back supported.'},
      {id:'leg-press', title:'Leg Press', sets:'4×10', category:'Legs', blurb:'Stable; drive evenly through feet.'},
      {id:'smith-squat', title:'Smith Machine Squat', sets:'4×8–10', category:'Legs', blurb:'Consistent path; stance to bias quads/glutes.'}
    ],
    'd2-rdl': [
      {id:'barbell-rdl', title:'Romanian Deadlift', sets:'3×8', category:'Pull', blurb:'Hinge; hamstrings/glutes; bar close.'},
      {id:'db-rdl', title:'Dumbbell RDL', sets:'3×10', category:'Pull', blurb:'Shoulder-friendly; same hinge pattern.'},
      {id:'smith-rdl', title:'Smith Machine RDL', sets:'3×8–10', category:'Pull', blurb:'Stable path; focus on stretch.'}
    ],
    'd2-lunge': [
      {id:'walking-lunge', title:'Walking Lunges', sets:'2×12/leg', category:'Legs', blurb:'Stride length sets quad vs glute bias.'},
      {id:'bulgarian', title:'Bulgarian Split Squat', sets:'2×10/leg', category:'Legs', blurb:'Unilateral; big quad/glute stimulus.'},
      {id:'reverse-lunge', title:'Reverse Lunges', sets:'2×12/leg', category:'Legs', blurb:'Knee-friendly; controlled steps back.'}
    ],
    'd2-hangleg': [
      {id:'hanging-leg-raise', title:'Hanging Leg Raises', sets:'3×12–15', category:'Core', blurb:'Lower abs; control descent.'},
      {id:'captains-chair', title:'Captain’s Chair Knee Raise', sets:'3×12–15', category:'Core', blurb:'Support for strict reps.'},
      {id:'lying-leg-raise', title:'Lying Leg Raise', sets:'3×15', category:'Core', blurb:'Posterior pelvic tilt; no sway.'}
    ],
    'd2-sideplank': [
      {id:'side-plank', title:'Side Plank', sets:'3×30–45s/side', category:'Core', blurb:'Obliques & posture.'},
      {id:'copenhagen-plank', title:'Copenhagen Side Plank (light)', sets:'3×20–30s/side', category:'Core', blurb:'Adductors + obliques; knee-supported.'},
      {id:'pallof-press', title:'Cable Pallof Press', sets:'3×10/side', category:'Core', blurb:'Anti-rotation; ribs down.'}
    ],
    'd3-incline': [
      {id:'incline-db', title:'Incline Dumbbell Press', sets:'3×8–10', category:'Push', blurb:'Upper chest; shoulder-friendly.'},
      {id:'incline-barbell', title:'Incline Barbell Press', sets:'3×6–8', category:'Push', blurb:'Heavier loading; controlled descent.'},
      {id:'incline-machine', title:'Incline Chest Press (Machine)', sets:'3×10', category:'Push', blurb:'Stable & focused on pecs.'}
    ],
    'd3-row': [
      {id:'seated-cable-row', title:'Seated Cable Row', sets:'3×10', category:'Pull', blurb:'Controlled horizontal pull.'},
      {id:'cs-machine-row', title:'Chest-Supported Row (Machine)', sets:'3×10', category:'Pull', blurb:'Low-back friendly; squeeze.'},
      {id:'db-row', title:'1-Arm Dumbbell Row', sets:'3×10/side', category:'Pull', blurb:'Unilateral lat focus.'}
    ],
    'd3-swing': [
      {id:'kb-swing', title:'Kettlebell Swings', sets:'3×15', category:'Power', blurb:'Explosive hinge; snap hips.'},
      {id:'db-swing', title:'Dumbbell Swings', sets:'3×15', category:'Power', blurb:'KB alternative; same pattern.'},
      {id:'cable-pullthrough', title:'Cable Pull-Through', sets:'3×12–15', category:'Power', blurb:'Posterior chain; hinge pattern.'}
    ],
    'd4-incline': [
      {id:'incline-barbell', title:'Incline Bench Press', sets:'3×8', category:'Push', blurb:'Upper chest focus.'},
      {id:'incline-db', title:'Incline Dumbbell Press', sets:'3×10', category:'Push', blurb:'ROM & joint friendly.'},
      {id:'incline-machine', title:'Incline Chest Press (Machine)', sets:'3×10', category:'Push', blurb:'Constant tension.'}
    ],
    'd4-pull': [
      {id:'pull-ups', title:'Pull-Ups / Chin-Ups', sets:'3×8–10', category:'Pull', blurb:'Lats/biceps; full ROM.'},
      {id:'lat-pulldown', title:'Lat Pulldown', sets:'3×10', category:'Pull', blurb:'Vertical pull; adjustable load.'},
      {id:'assisted-pullup', title:'Assisted Pull-Up Machine', sets:'3×10', category:'Pull', blurb:'Same pattern with support.'}
    ],
    'd4-ohplight': [
      {id:'seated-db-press', title:'Overhead Press (lighter)', sets:'3×10', category:'Push', blurb:'Shoulders/triceps; lighter load.'},
      {id:'machine-shoulder-press', title:'Machine Shoulder Press', sets:'3×12', category:'Push', blurb:'High-rep shoulder shaping.'},
      {id:'arnold-press', title:'Arnold Press (DB)', sets:'3×10', category:'Push', blurb:'Front/side delt emphasis.'}
    ],
    'd4-facepull': [
      {id:'face-pull', title:'Face Pulls', sets:'3×12–15', category:'Pull', blurb:'Rear delts/rotator cuff.'},
      {id:'reverse-pec-deck', title:'Reverse Pec Deck', sets:'3×12–15', category:'Pull', blurb:'Machine rear delt fly.'}
    ],
    'd4-biceps': [
      {id:'db-curl', title:'Biceps Curls', sets:'2×12', category:'Accessory', blurb:'DB curls; strict form.'},
      {id:'cable-curl', title:'Cable Curl (EZ/Bar)', sets:'2×12', category:'Accessory', blurb:'Constant tension.'},
      {id:'preacher', title:'Preacher Curl (Machine/Bench)', sets:'2×10–12', category:'Accessory', blurb:'Locked-in elbow; peak focus.'}
    ],
    'd4-triceps': [
      {id:'rope-pushdown', title:'Triceps Rope Pushdowns', sets:'2×12', category:'Accessory', blurb:'Elbows pinned; full extension.'},
      {id:'bar-pushdown', title:'Straight-Bar Pushdown', sets:'2×12', category:'Accessory', blurb:'Heavier loading.'},
      {id:'oh-cable-ext', title:'Overhead Cable Extension', sets:'2×12', category:'Accessory', blurb:'Long head stretch.'}
    ],
    'd5-front': [
      {id:'front-squat', title:'Front Squat', sets:'3×8', category:'Legs', blurb:'Quads/core; upright torso.'},
      {id:'goblet-squat', title:'Goblet Squat', sets:'3×10', category:'Legs', blurb:'DB/kettlebell; posture drill.'},
      {id:'hack-squat', title:'Hack Squat (Machine)', sets:'3×10', category:'Legs', blurb:'Quad emphasis; guided path.'},
      {id:'leg-press', title:'Leg Press (Quad Bias)', sets:'3×12', category:'Legs', blurb:'Feet low/narrow for quads.'}
    ],
    'd5-hip': [
      {id:'barbell-hip-thrust', title:'Barbell Hip Thrust', sets:'3×8–10', category:'Legs', blurb:'Glute strength & shape.'},
      {id:'smith-hip-thrust', title:'Smith Machine Hip Thrust', sets:'3×10', category:'Legs', blurb:'Stable path; easy setup.'},
      {id:'glute-drive', title:'Glute Drive / Hip Thrust Machine', sets:'3×10', category:'Legs', blurb:'Machine-supported thrust.'}
    ],
    'd5-legcurl': [
      {id:'lying-leg-curl', title:'Leg Curl (Lying)', sets:'3×10–12', category:'Pull', blurb:'Hamstring isolation.'},
      {id:'seated-leg-curl', title:'Leg Curl (Seated)', sets:'3×10–12', category:'Pull', blurb:'Great lengthened tension.'},
      {id:'nordic-assisted', title:'Nordic Curl (Assisted)', sets:'3×6–8', category:'Pull', blurb:'High tension; control descent.'}
    ],
    'd5-bulg': [
      {id:'bulgarian', title:'Bulgarian Split Squat', sets:'2×12/leg', category:'Legs', blurb:'Single-leg quad/glute.'},
      {id:'step-up', title:'Step-Ups (DB)', sets:'2×10/leg', category:'Legs', blurb:'Knee drive; control descent.'},
      {id:'smith-split-squat', title:'Smith Split Squat', sets:'2×10/leg', category:'Legs', blurb:'Guided path; balance assist.'}
    ]
  };

  // ===== External link resolver (MuscleWiki primary; ExRx fallback via site search) =====
  // Map some common movements to stable MuscleWiki slugs. For everything else, fall back to site search.
  const MW_MAP = {
    'Barbell Bench Press':'https://musclewiki.com/exercise/barbell-bench-press',
    'Dumbbell Bench Press':'https://musclewiki.com/exercise/dumbbell-bench-press',
    'Machine Chest Press':'https://musclewiki.com/exercise/machine-chest-press',
    'Push-Ups (Weighted/Assisted)':'https://musclewiki.com/exercise/push-up',
    'Pull-Ups':'https://musclewiki.com/exercise/pull-ups',
    'Lat Pulldown':'https://musclewiki.com/exercise/machine-pulldown',
    'Assisted Pull-Up Machine':'https://musclewiki.com/exercise/machine-assisted-pull-up',
    'Inverted Row (Smith/TRX)':'https://musclewiki.com/exercise/smith-machine-inverted-row',
    'Barbell Overhead Press':'https://musclewiki.com/exercise/barbell-overhead-press',
    'Dumbbell Shoulder Press (Seated)':'https://musclewiki.com/exercise/dumbbell-seated-overhead-press',
    'Machine Shoulder Press':'https://musclewiki.com/exercise/machine-overhand-overhead-press',
    'Barbell Row':'https://musclewiki.com/exercise/barbell-pronated-row',
    'Seated Cable Row':'https://musclewiki.com/exercise/machine-seated-cable-row',
    'Chest-Supported Row (Machine)':'https://musclewiki.com/exercise/cable-rope-upright-row',
    '1-Arm Dumbbell Row (Bench)':'https://musclewiki.com/exercise/dumbbell-single-arm-row',
    'Dumbbell Lateral Raises':'https://musclewiki.com/exercise/dumbbell-lateral-raise',
    'Cable Lateral Raise':'https://musclewiki.com/exercise/cable-low-single-arm-lateral-raise',
    'Machine Lateral Raise':'https://musclewiki.com/exercise/machine-standing-lateral-raise',
    'Back Squat':'https://musclewiki.com/exercise/bodyweight-squat',
    'Hack Squat (Machine)':'https://musclewiki.com/exercise/machine-hack-squat',
    'Leg Press':'https://musclewiki.com/exercise/machine-leg-press',
    'Smith Machine Squat':'https://musclewiki.com/exercise/smith-machine-squat',
    'Romanian Deadlift':'https://musclewiki.com/exercise/barbell-romanian-deadlift',
    'Dumbbell RDL':'https://musclewiki.com/exercise/dumbbell-romanian-deadlift',
    'Smith Machine RDL':'https://musclewiki.com/exercise/smith-machine-romanian-deadlift',
    'Walking Lunges':'https://musclewiki.com/exercise/lunge-walking',
    'Bulgarian Split Squat':'https://musclewiki.com/exercise/barbell-bulgarian-split-squat',
    'Reverse Lunges':'https://musclewiki.com/exercise/bodyweight-reverse-lunge',
    'Hanging Leg Raises':'https://musclewiki.com/exercise/hanging-knee-raises',
    'Captain’s Chair Knee Raise':'https://musclewiki.com/exercise/hanging-knee-raises',
    'Lying Leg Raise':'https://musclewiki.com/exercise/hanging-knee-raises',
    'Side Plank':'https://musclewiki.com/exercise/side-plank-up-down',
    'Copenhagen Side Plank (light)':'https://musclewiki.com/exercise/trx-forearm-side-plank',
    'Cable Pallof Press':'https://musclewiki.com/exercise/cable-pallof-press',
    'Incline Dumbbell Press':'https://musclewiki.com/exercise/dumbbell-incline-bench-press',
    'Incline Barbell Press':'https://musclewiki.com/exercise/barbell-incline-bench-press',
    'Incline Chest Press (Machine)':'https://musclewiki.com/exercise/machine-plate-loaded-incline-chest-press',
    'Kettlebell Swings':'https://musclewiki.com/exercise/kettlebell-swing',
    'Dumbbell Swings':'https://musclewiki.com/exercise/kettlebell-swing',
    'Cable Pull-Through':'https://musclewiki.com/exercise/cable-pull-through',
    'Face Pulls':'https://musclewiki.com/exercise/machine-face-pulls',
    'Reverse Pec Deck':'https://musclewiki.com/exercise/machine-pec-fly',
    'Biceps Curls':'https://musclewiki.com/exercise/dumbbell-curl',
    'Cable Curl (EZ/Bar)':'https://musclewiki.com/exercise/cable-single-arm-bayesian-curl',
    'Preacher Curl (Machine/Bench)':'https://musclewiki.com/exercise/machine-seated-plate-loaded-preacher-curl',
    'Triceps Rope Pushdowns':'https://musclewiki.com/exercise/cable-rope-pushdown',
    'Straight-Bar Pushdown':'https://musclewiki.com/exercise/cable-bar-pushdown',
    'Overhead Cable Extension':'https://musclewiki.com/exercise/cable-rope-overhead-tricep-extension',
    'Front Squat':'https://musclewiki.com/exercise/barbell-front-squat-bodybuilding',
    'Goblet Squat':'https://musclewiki.com/exercise/dumbbell-goblet-squat',
    'Barbell Hip Thrust':'https://musclewiki.com/exercises/glutes/barbell/hip-thrust',
    'Smith Machine Hip Thrust':'https://musclewiki.com/exercise/smith-machine-hip-thrust',
    'Glute Drive / Hip Thrust Machine':'https://musclewiki.com/exercise/machine-hip-abduction',
    'Leg Curl (Lying)':'https://musclewiki.com/exercise/cable-single-leg-laying-leg-curl',
    'Leg Curl (Seated)':'https://musclewiki.com/exercise/seated-leg-curl',
    'Nordic Curl (Assisted)':'https://musclewiki.com/exercise/nordic-hamstring-curl',
    'Arnold Press (DB)':'https://musclewiki.com/exercise/dumbbell-arnold-press',
    'Incline Bench Press':'https://musclewiki.com/exercises/chest/barbell/incline-bench-press',
    'Pull-Ups / Chin-Ups':'https://musclewiki.com/exercises/back/bodyweight/pull-up',
    'Overhead Press (lighter)':'https://musclewiki.com/exercise/dumbbell-overhead-press'

  };
  function siteSearch(base, q){ return `${base}${encodeURIComponent(q)}`; }
  const MW_SEARCH = 'https://duckduckgo.com/?q=site%3Amusclewiki.com+';
  const EXRX_SEARCH = 'https://duckduckgo.com/?q=site%3Aexrx.net+';

  function resolveExerciseUrl(title){
    // strip any set tag from link text if present
    const clean = title.replace(/\s*\u00D7?\s*\d+[^)]*$/,'').trim();
    // exact map first
    if(MW_MAP[clean]) return MW_MAP[clean];
    // try common simplifications
    const sim = clean.replace(/\s*\(.*?\)\s*/g,'').replace(/\s{2,}/g,' ').trim();
    if(MW_MAP[sim]) return MW_MAP[sim];
    // fallback: site search (MuscleWiki primary, ExRx backup chained with OR)
    return siteSearch(MW_SEARCH, clean) + '+OR+' + encodeURIComponent(`site:exrx.net ${clean}`);
  }

  // Attach variant button, apply saved variant, and wire name links to external form
  document.querySelectorAll('.ex').forEach(ex=>{
    const cb = ex.querySelector('input[data-key]'); if(!cb) return;
    const key = cb.dataset.key;
    const options = VARIANTS[key];
    const contentBox = ex.querySelector('.content');
    let nameLink = contentBox?.querySelector('a.ex-link');
  // --- Ensure required elements exist so names/descriptions can render ---
    if (contentBox) {
  // Create the anchor if it's missing (and move any existing <strong> into it)
      if (!nameLink) {
        nameLink = document.createElement('a');
        nameLink.className = 'ex-link';
        nameLink.href = '#';

        // If there is already a <strong>, wrap/migrate it; otherwise create one
        let strong = contentBox.querySelector('strong');
        if (!strong) {
          strong = document.createElement('strong');
          strong.textContent = (ex.getAttribute('data-ex') || 'Exercise').trim();
        } else {
          strong = strong.cloneNode(true); // clone in case we’re reusing
        }
        nameLink.appendChild(strong);

        // Insert link at the top of the content box
        contentBox.insertBefore(nameLink, contentBox.firstChild);
      }

      // Ensure there is a <small> description element
      if (!contentBox.querySelector('small')) {
        const small = document.createElement('small');
        small.textContent = ''; // variant apply will fill this in
        // Place it right after the name link (or at end if needed)
        if (nameLink.nextSibling) {
          contentBox.insertBefore(small, nameLink.nextSibling);
        } else {
          contentBox.appendChild(small);
        }
      }
    }
    // ----------------------------------------------------------------------

    const metaEl  = ex.querySelector('.meta');
    const vb = ex.querySelector('.mid .variant-btn');

    // menu + selection if variants exist
    if(options){
      const saved = savedVariant[key] || options[0].id;
      const cur = options.find(o=>o.id===saved) || options[0];
      applyVariant(cur);

      vb.addEventListener('click', (e)=>{
        e.stopPropagation();
        document.querySelectorAll('.variant-menu').forEach(m=>m.remove());
        const menu=document.createElement('div'); menu.className='variant-menu';
        const h=document.createElement('h4'); h.textContent='Choose alternative'; menu.appendChild(h);
        options.forEach(o=>{
          const b=document.createElement('button'); b.type='button'; b.className='variant-opt';
          b.innerHTML=`<div class="title">${o.title} <span class="sets">${o.sets}</span></div><div class="cat">${o.category}</div>`;
          const sub=document.createElement('small'); sub.textContent=o.blurb; b.appendChild(sub);
          b.addEventListener('click', ()=>{ savedVariant[key]=o.id; setLS(variantKey, savedVariant); applyVariant(o); flashToast('Exercise updated'); menu.remove(); });
          menu.appendChild(b);
        });
        document.body.appendChild(menu);
        const r=vb.getBoundingClientRect();
        Object.assign(menu.style,{left:(r.left+window.scrollX)+'px',top:(r.bottom+window.scrollY+6)+'px'});
        requestAnimationFrame(()=>menu.classList.add('open'));
      });

      function applyVariant(o){
        // Update the exercise name (inside the <a><strong>…</strong></a>)
        if(nameLink){
          let strong = nameLink.querySelector('strong');
          if(!strong){
            strong = document.createElement('strong');
            nameLink.innerHTML = '';
            nameLink.appendChild(strong);
          }
          strong.innerHTML = `${o.title} <span class="tag">${o.sets}</span>`;
        }

        // Update the description (the <small> right below)
        const small = contentBox?.querySelector('small');
        if(small) small.textContent = o.blurb;

        // Update the category label (right-hand meta)
        if(metaEl) metaEl.textContent = o.category;

        // Save info in dataset for timers + links
        ex.setAttribute('data-ex', o.title);
        ex.setAttribute('data-variant', o.id);
      }
    }

    // clicking the NAME opens external form help (variants respected)
    if(nameLink){
      nameLink.addEventListener('click', (e)=>{
        e.preventDefault();
        const currentTitle = ex.getAttribute('data-ex') || nameLink.textContent || 'Exercise';
        const url = resolveExerciseUrl(currentTitle.trim());
        window.open(url, '_blank', 'noopener,noreferrer');
      });
    }
  });

  document.addEventListener('click', ()=>{ document.querySelectorAll('.variant-menu').forEach(m=>m.remove()); });
  document.addEventListener('scroll', ()=>{ document.querySelectorAll('.variant-menu').forEach(m=>m.remove()); }, true);

  // ===== Rest Timers =====
  const timersHost = document.querySelector('.running-timers');
  const restKey = 'pocket:rest';
  const savedRestTimes = getLS(restKey, {}); // { "<exKey>::<variantId>": seconds }
  const PRESETS = [30,60,90,120,180];

  function suggestedSeconds(exRow){
    const role=(exRow.querySelector('.meta')?.textContent||'').toLowerCase();
    if(role.includes('accessory')) return 60;
    if(role.includes('core')) return 60;
    if(role.includes('power')) return 90;
    if(role.includes('legs')||role.includes('push')||role.includes('pull')) return 120;
    return 90;
  }
  function fmt(s){ const m=Math.floor(s/60), r=s%60; return `${m}:${String(r).padStart(2,'0')}`; }
  function startTimer(label, seconds){
    const pill=document.createElement('div'); pill.className='timer-pill';
    const name=document.createElement('span'); name.className='name'; name.textContent=label;
    const time=document.createElement('span'); time.className='time'; time.textContent=fmt(seconds);
    const cancel=document.createElement('button'); cancel.setAttribute('aria-label','Cancel timer'); cancel.textContent='✕';
    pill.append(name,time,cancel); timersHost.appendChild(pill);
    let t=seconds; const iv=setInterval(()=>{ t--; time.textContent=fmt(t); if(t<=0){ clearInterval(iv); pill.remove(); flashToast('Go!'); if(navigator.vibrate){ try{ navigator.vibrate([150,80,150]); }catch(_){ } } } },1000);
    const kill=()=>{ clearInterval(iv); pill.remove(); flashToast('Timer canceled'); };
    cancel.addEventListener('click', (e)=>{ e.stopPropagation(); kill(); });
    pill.addEventListener('click', (e)=>{ if(e.target!==cancel) kill(); });
  }

  document.querySelectorAll('.ex').forEach(ex=>{
    const cb=ex.querySelector('input[data-key]'); if(!cb) return;
    const key=cb.dataset.key;
    const left=ex.querySelector('.left'); if(!left) return;

    let tBtn = left.querySelector('.timer-btn'); if(!tBtn){ tBtn=document.createElement('button'); tBtn.type='button'; tBtn.className='timer-btn'; tBtn.setAttribute('aria-label','Start rest timer'); tBtn.textContent='⏱'; left.appendChild(tBtn); }
    let pBtn = left.querySelector('.preset-btn'); if(!pBtn){ pBtn=document.createElement('button'); pBtn.type='button'; pBtn.className='preset-btn'; pBtn.setAttribute('aria-label','Timer presets'); pBtn.textContent='⋯'; left.appendChild(pBtn); }

    const variantId = ()=> ex.dataset.variant || 'default';
    const restMapKey = ()=> `${key}::${variantId()}`;
    const label = ()=> (ex.getAttribute('data-ex') || ex.querySelector('.content strong')?.textContent || 'Exercise').trim().replace(/\s*\(.+?\)/,'');

    tBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      const custom = savedRestTimes[restMapKey()];
      const secs = Number(custom ?? suggestedSeconds(ex));
      startTimer(label().slice(0,36), secs);
    });

    pBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      document.querySelectorAll('.rt-menu').forEach(m=>m.remove());
      const menu=document.createElement('div'); menu.className='rt-menu';
      const title=document.createElement('h4'); title.textContent='Rest presets'; menu.appendChild(title);
      const row=document.createElement('div'); row.className='rt-row'; menu.appendChild(row);

      PRESETS.forEach(s=>{
        const chip=document.createElement('button'); chip.type='button'; chip.className='rt-chip'; if(savedRestTimes[restMapKey()]==s) chip.classList.add('active'); chip.textContent=s+'s';
        chip.addEventListener('click', ()=>{ savedRestTimes[restMapKey()]=s; setLS(restKey, savedRestTimes); startTimer(label().slice(0,36), s); flashToast(`Preset set: ${s}s`); menu.remove(); });
        row.appendChild(chip);
      });

      const revert=document.createElement('button'); revert.type='button'; revert.className='rt-chip'; revert.textContent='Revert to suggested';
      revert.addEventListener('click', ()=>{ delete savedRestTimes[restMapKey()]; setLS(restKey, savedRestTimes); flashToast('Using suggested time'); menu.remove(); });
      const row2=document.createElement('div'); row2.className='rt-row'; row2.appendChild(revert); menu.appendChild(row2);

      document.body.appendChild(menu);
      const r=pBtn.getBoundingClientRect();
      Object.assign(menu.style,{left:(r.left+window.scrollX-10)+'px', top:(r.bottom+window.scrollY+6)+'px'});
      requestAnimationFrame(()=>menu.classList.add('open'));
      const close=()=>menu?.remove(); setTimeout(()=>{ document.addEventListener('click', close, {once:true}); },0);
    });
  });

})();
</script>
</body>
</html>